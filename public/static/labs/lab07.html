<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.38">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="STA 101">

<title>Lab 07: Journey to the center of the limit</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="lab07_files/libs/clipboard/clipboard.min.js"></script>
<script src="lab07_files/libs/quarto-html/quarto.js"></script>
<script src="lab07_files/libs/quarto-html/popper.min.js"></script>
<script src="lab07_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="lab07_files/libs/quarto-html/anchor.min.js"></script>
<link href="lab07_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="lab07_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="lab07_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="lab07_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="lab07_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="labs2.css">
</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Lab 07: Journey to the center of the limit</h1>
<p class="subtitle lead">Due Thursday November 3 at 11:59pm</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>STA 101 </p>
          </div>
  </div>
    
    
  </div>
  

</header>

<p>By the end of this lab you will</p>
<ul>
<li>perform CLT based inference</li>
<li>practice Bayes theorem</li>
<li>construct confidence intervals</li>
</ul>
<section id="getting-started" class="level2">
<h2 class="anchored" data-anchor-id="getting-started">Getting started</h2>
<p>&nbsp;1. Download the lab template by pasting the code below in your <strong>console</strong>:</p>
<pre><code>download.file("https://sta101-fa22.netlify.app/static/labs/lab07_template.qmd",
              destfile = "lab07.qmd")</code></pre>
<p>&nbsp;2. Under the “Files” tab on the right hand side, click on <code>lab07.qmd</code> to open the lab template.</p>
<p>&nbsp;3. Complete the exercises below using the space provided.</p>
</section>
<section id="warm-up" class="level2">
<h2 class="anchored" data-anchor-id="warm-up">Warm up</h2>
<p>Be sure to update the YAML at the top of the document to include your name and the date.</p>
<section id="packages" class="level3">
<h3 class="anchored" data-anchor-id="packages">Packages</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidymodels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout-important callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>Render as you work! Render at least before and after each exercise to avoid last minute rendering issues.</p>
</div>
</div>
</section>
</section>
<section id="exercises" class="level2">
<h2 class="anchored" data-anchor-id="exercises">Exercises</h2>
<ol type="1">
<li>Students in a previous semester of STA101 scored an average midterm score of 32 (out of 50) with a standard deviation of 4. Assume normality.</li>
</ol>
<ul>
<li>What is the probability an individual student scored less than 28?</li>
<li>What score did only 10 percent of the class exceed?</li>
<li>I pick 10 students at random. What is the standard error of their average score? What is the probability that their average score exceeds 33?</li>
<li>I pick 15 students at random. What is the probability that exactly 4 were in the top 20% of the class? Hint: how would you model this? Please answer exactly <em>and</em> use simulation to approximate the solution.</li>
</ul>
<ol start="2" type="1">
<li>A manufacturer ships orange juice from Florida to North Carolina in containers of 50 cartons. The mean weight of a carton is 4.23 lbs with 0.02 standard deviation. The manufacturer is interested in</li>
</ol>
<p><span class="math display">\[
P(\text{50 cartons weigh more than 211.8 lbs})
\]</span></p>
<p>Assume the weight of an individual carton is normally distributed. Compute the above probability. Explain your method.</p>
<ol start="3" type="1">
<li>Bayes theorem states that for two events, <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>,</li>
</ol>
<p><span class="math display">\[
P(A|B) = \frac{P(B|A)P(A)}{P(B)}.
\]</span></p>
<p><strong>Scenario</strong>: An individual takes a COVID test. Using Bayes theorem above, what is the probability they have COVID given the test is positive? In math, what’s <em>P(Covid | Pos)</em>? We will define the following events:</p>
<ul>
<li><strong>Pos</strong>: The event the test returns positive.</li>
<li><strong>Neg</strong>: The event the test returns negative.</li>
<li><strong>Covid</strong>: The event a person has COVID</li>
<li><strong>No Covid</strong>: The event a person does not have COVID</li>
</ul>
<p>Assume the test has an estimated sensitivity of 100%, <em>P(Pos | Covid) = 1</em>, and specificity of 99%, <em>P(Neg | No Covid) = 0.99</em>. Suppose the prevalence of COVID-19 in the general population is about 2%, <em>P(Covid) = 0.02</em>.</p>
<ul>
<li>Use R as a calculator within a code chunk to show all your work.</li>
</ul>
<div class="callout-hint callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Hint
</div>
</div>
<div class="callout-body-container callout-body">
<p>For any event <span class="math inline">\(A\)</span>, <em>P(A) + P(not A) = 1</em>. Similarly, <em>P(B) = P(B|A)P(A) + P(B | not A) P(not A)</em>.</p>
</div>
</div>
<section id="data" class="level3">
<h3 class="anchored" data-anchor-id="data">Data</h3>
<p>For the following questions, use the data sets below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>ultra_rankings <span class="ot">=</span> <span class="fu">read_csv</span>(</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"~/Desktop/ultra_rankings.csv"</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>race <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">"https://sta101-fa22.netlify.app/static/labs/data/race.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The data for this lab is from the Ultra Trail Running data set featured in Tidy Tuesday. You can find the codebook with variable definitions in the Tidy Tuesday repo <a href="https://github.com/rfordatascience/tidytuesday/blob/master/data/2021/2021-10-26/readme.md">here</a>.</p>
<ol start="4" type="1">
<li>To begin, join the data frames. Save your result as <code>ultra</code>. Next, drop all rows <strong>without</strong> an observed race <code>time_in_seconds</code>. Your final data frame should have 60914 rows and 20 columns. Print the number of rows of <code>ultra</code> to the screen.</li>
</ol>
<div class="cell">

</div>
<ol start="5" type="1">
<li><p>Your friend computes the mean time in seconds it takes participants of 170+ km races to finish. Your friend also constructs a 90% confidence interval and states, “There is a .9 probability that the sample mean race time for races over 170 km is between 130000 and 160000 seconds.” Without running any code, what is wrong with your friend’s statement? Please correct the statement as well (without running any code).</p></li>
<li><p>Report the mean race time for races 170 km or longer. Construct a 99% bootstrap confidence interval for the mean race time using <code>set.seed(6)</code> and 5000 reps. Check that central limit theorem holds, do you need to make any assumptions? Use CLT to construct a 99% confidence interval. Compare your result to your bootstrap interval. Interpret the interval.</p></li>
<li><p>Identify at least two anomalies in the data set. For example, if the same runner ran a race in two different countries on the same day, that would be an anomaly. While this example is false, there are indeed real anomalies in the data. For full credit, display your anomaly either via code (printing to screen) or via a visualization. Discuss your findings.</p></li>
<li><p>Given the race was in Argentina, what is the median age of runners? Can you use Central Limit Theorem (CLT) to construct a confidence interval about this estimate? Explain. If not, construct a 90% bootstrap confidence interval that bounds the median from below. Use <code>set.seed(8)</code> and 10000 reps. Interpret your interval in context.</p></li>
</ol>
<ul>
<li>Note, this is not a symmetric confidence interval!</li>
</ul>
</section>
</section>
<section id="formatting" class="level2">
<h2 class="anchored" data-anchor-id="formatting">Formatting</h2>
<p><strong>Reminder</strong>: For all assignments in this course there is a “formatting” component to the grade. To receive full points for “formatting”, you must:</p>
<p>&nbsp;1. Have your name at the top of the rendered document</p>
<p>&nbsp;2. Pipes <code>%&gt;%</code> and ggplot layers <code>+</code> should be followed by a newline (see formatting above)</p>
<p>&nbsp;3. Your code should be under the 80 character code limit. (You shouldn’t have to scroll to see all your code on the rendered document).</p>
<p>&nbsp;4. All exercises and corresponding pages should be linked on gradescope.</p>
<p>These necessary “tidyverse” style choices are good general practice and will help make your code more legible. For a more extensive list of recommended guidelines, <a href="https://style.tidyverse.org/">click here</a>.</p>
</section>
<section id="submitting-to-gradescope" class="level2">
<h2 class="anchored" data-anchor-id="submitting-to-gradescope">Submitting to gradescope</h2>
<p>Once you are fully satisfied with your lab, render to .pdf to create a .pdf document. You may notice that the formatting/theme of the report has changed – this is expected. Remember – you must turn in a .pdf file to the Gradescope page before the submission deadline for credit. To submit your assignment:</p>
<ul>
<li><p>Go to <a href="http://www.gradescope.com">http://www.gradescope.com</a> and click Log in in the top right corner. - Click <code>School Credentials</code>, <code>Duke NetID</code> and log in using your NetID credentials.</p></li>
<li><p>Click on your STA 101 course.</p></li>
<li><p>Click on the assignment, and you’ll be prompted to submit it.</p></li>
<li><p>Mark the pages associated with each exercise. All of the papers of your lab should be associated with at least one question (i.e., should be “checked”). Select the first page of your .pdf submission to be associated with the “Formatting” section.</p></li>
</ul>
</section>
<section id="grading" class="level2">
<h2 class="anchored" data-anchor-id="grading">Grading</h2>
<p>Total: 50 pts.</p>
<pre><code>Workflow and formatting - 4pts
Ex 1 - 7pts
Ex 2 - 5pts
Ex 3 - 4pts
Ex 4 - 5pts
Ex 5 - 4pts
Ex 6 - 8pts
Ex 7 - 6pts
Ex 8 - 7pts</code></pre>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>